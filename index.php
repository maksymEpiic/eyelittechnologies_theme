<?php
/**
 * The main template file
 *
 * This is the most generic template file in a WordPress theme
 * and one of the two required files for a theme (the other being style.css).
 * It is used to display a page when nothing more specific matches a query.
 * E.g., it puts together the home page when no home.php file exists.
 *
 * @link https://developer.wordpress.org/themes/basics/template-hierarchy/
 *
 * @package eyelittechnologies
 */

get_header();

$paged = max( 1, get_query_var('paged'), get_query_var('page') );

$args = array(
    'post_type'      => 'post',
    'post_status'    => 'publish',
    'posts_per_page' => 12,
    'paged'          => $paged,
);

// Формируем tax_query, если в URL переданы фильтры
$tax_query = array();

if ( isset( $_GET['content_type'] ) && ! empty( $_GET['content_type'] ) ) {
    // Разбиваем строку по запятой и обрабатываем каждый термин
    $content_types = array_map( 'sanitize_text_field', explode( ',', $_GET['content_type'] ) );
    $tax_query[] = array(
        'taxonomy' => 'content-type',
        'field'    => 'slug',
        'terms'    => $content_types,
    );
}

if ( isset( $_GET['industry'] ) && ! empty( $_GET['industry'] ) ) {
    $industry = array_map( 'sanitize_text_field', explode( ',', $_GET['industry'] ) );
    $tax_query[] = array(
        'taxonomy' => 'industry',
        'field'    => 'slug',
        'terms'    => $industry,
    );
}

if ( ! empty( $tax_query ) ) {
    // Если оба фильтра заданы, можно использовать отношение AND
    if ( count( $tax_query ) > 1 ) {
        $tax_query['relation'] = 'AND';
    }
    $args['tax_query'] = $tax_query;
}

$blog_page_id  = get_option('page_for_posts');
$blog_page_url = get_permalink( $blog_page_id );

$query = new WP_Query( $args );

?>

    <main class="site-page blog">

        <section class="breadcrumbs descktop_hide">
            <ul>
                <li><a href="/">Home</a> / </li>
                <li><span>Blog</span></li>

            </ul>
        </section>

        <section class="page_hero_block industry_hero mes_hero blog_hero">
            <div class="container">
                <div class="hero_wrap">
                    <div class="image_block_hero">
                        <div class="sub_logo_wrap">
                            <svg width="528" height="93" viewBox="0 0 528 93" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect width="528" height="93" rx="40" fill="#F7F7F7"/>
                                <path d="M261.641 59H258.438V47.5156C258.438 45.3021 258.092 43.7005 257.402 42.7109C256.725 41.7214 255.579 41.2266 253.965 41.2266C252.598 41.2266 251.432 41.8516 250.469 43.1016C249.518 44.3516 249.043 45.849 249.043 47.5938V59H245.84V47.125C245.84 43.1927 244.323 41.2266 241.289 41.2266C239.883 41.2266 238.724 41.819 237.812 43.0039C236.901 44.1758 236.445 45.7057 236.445 47.5938V59H233.242V39H236.445V42.1641H236.523C237.943 39.7422 240.013 38.5312 242.734 38.5312C244.102 38.5312 245.293 38.9154 246.309 39.6836C247.324 40.4388 248.021 41.4349 248.398 42.6719C249.883 39.9115 252.096 38.5312 255.039 38.5312C259.44 38.5312 261.641 41.2461 261.641 46.6758V59ZM282.012 59H278.809V55.875H278.73C277.337 58.2708 275.286 59.4688 272.578 59.4688C270.586 59.4688 269.023 58.9414 267.891 57.8867C266.771 56.832 266.211 55.4323 266.211 53.6875C266.211 49.9505 268.411 47.776 272.812 47.1641L278.809 46.3242C278.809 42.9258 277.435 41.2266 274.688 41.2266C272.279 41.2266 270.104 42.0469 268.164 43.6875V40.4062C270.13 39.1562 272.396 38.5312 274.961 38.5312C279.661 38.5312 282.012 41.0182 282.012 45.9922V59ZM278.809 48.8828L273.984 49.5469C272.5 49.7552 271.38 50.1263 270.625 50.6602C269.87 51.181 269.492 52.112 269.492 53.4531C269.492 54.4297 269.837 55.2305 270.527 55.8555C271.23 56.4674 272.161 56.7734 273.32 56.7734C274.909 56.7734 276.217 56.2201 277.246 55.1133C278.288 53.9935 278.809 52.5807 278.809 50.875V48.8828ZM304.648 59H301.445V47.5938C301.445 43.349 299.896 41.2266 296.797 41.2266C295.195 41.2266 293.867 41.832 292.812 43.043C291.771 44.2409 291.25 45.7578 291.25 47.5938V59H288.047V39H291.25V42.3203H291.328C292.839 39.7943 295.026 38.5312 297.891 38.5312C300.078 38.5312 301.751 39.2409 302.91 40.6602C304.069 42.0664 304.648 44.1042 304.648 46.7734V59ZM326.875 59H323.672V55.8359H323.594C322.266 58.2578 320.208 59.4688 317.422 59.4688C312.656 59.4688 310.273 56.6302 310.273 50.9531V39H313.457V50.4453C313.457 54.6641 315.072 56.7734 318.301 56.7734C319.863 56.7734 321.146 56.2005 322.148 55.0547C323.164 53.8958 323.672 52.3854 323.672 50.5234V39H326.875V59ZM343.242 32.2031C342.617 31.8516 341.908 31.6758 341.113 31.6758C338.874 31.6758 337.754 33.0885 337.754 35.9141V39H342.441V41.7344H337.754V59H334.57V41.7344H331.152V39H334.57V35.7578C334.57 33.6615 335.176 32.0078 336.387 30.7969C337.598 29.5729 339.108 28.9609 340.918 28.9609C341.895 28.9609 342.669 29.0781 343.242 29.3125V32.2031ZM360.215 59H357.012V55.875H356.934C355.54 58.2708 353.49 59.4688 350.781 59.4688C348.789 59.4688 347.227 58.9414 346.094 57.8867C344.974 56.832 344.414 55.4323 344.414 53.6875C344.414 49.9505 346.615 47.776 351.016 47.1641L357.012 46.3242C357.012 42.9258 355.638 41.2266 352.891 41.2266C350.482 41.2266 348.307 42.0469 346.367 43.6875V40.4062C348.333 39.1562 350.599 38.5312 353.164 38.5312C357.865 38.5312 360.215 41.0182 360.215 45.9922V59ZM357.012 48.8828L352.188 49.5469C350.703 49.7552 349.583 50.1263 348.828 50.6602C348.073 51.181 347.695 52.112 347.695 53.4531C347.695 54.4297 348.04 55.2305 348.73 55.8555C349.434 56.4674 350.365 56.7734 351.523 56.7734C353.112 56.7734 354.421 56.2201 355.449 55.1133C356.491 53.9935 357.012 52.5807 357.012 50.875V48.8828ZM379.883 58.082C378.346 59.0065 376.523 59.4688 374.414 59.4688C371.562 59.4688 369.258 58.5443 367.5 56.6953C365.755 54.8333 364.883 52.4245 364.883 49.4688C364.883 46.1745 365.827 43.5312 367.715 41.5391C369.603 39.5339 372.122 38.5312 375.273 38.5312C377.031 38.5312 378.581 38.8568 379.922 39.5078V42.7891C378.438 41.7474 376.849 41.2266 375.156 41.2266C373.112 41.2266 371.432 41.9622 370.117 43.4336C368.815 44.8919 368.164 46.8125 368.164 49.1953C368.164 51.5391 368.776 53.388 370 54.7422C371.237 56.0964 372.891 56.7734 374.961 56.7734C376.706 56.7734 378.346 56.194 379.883 55.0352V58.082ZM394.004 58.8047C393.249 59.2214 392.253 59.4297 391.016 59.4297C387.513 59.4297 385.762 57.4766 385.762 53.5703V41.7344H382.324V39H385.762V34.1172L388.965 33.082V39H394.004V41.7344H388.965V53.0039C388.965 54.3451 389.193 55.3021 389.648 55.875C390.104 56.4479 390.859 56.7344 391.914 56.7344C392.721 56.7344 393.418 56.513 394.004 56.0703V58.8047ZM414.453 59H411.25V55.8359H411.172C409.844 58.2578 407.786 59.4688 405 59.4688C400.234 59.4688 397.852 56.6302 397.852 50.9531V39H401.035V50.4453C401.035 54.6641 402.65 56.7734 405.879 56.7734C407.441 56.7734 408.724 56.2005 409.727 55.0547C410.742 53.8958 411.25 52.3854 411.25 50.5234V39H414.453V59ZM431.367 42.2422C430.807 41.8125 430 41.5977 428.945 41.5977C427.578 41.5977 426.432 42.2422 425.508 43.5312C424.596 44.8203 424.141 46.5781 424.141 48.8047V59H420.938V39H424.141V43.1211H424.219C424.674 41.7148 425.371 40.6211 426.309 39.8398C427.246 39.0456 428.294 38.6484 429.453 38.6484C430.286 38.6484 430.924 38.7396 431.367 38.9219V42.2422ZM436.484 33.9219C435.911 33.9219 435.423 33.7266 435.02 33.3359C434.616 32.9453 434.414 32.4505 434.414 31.8516C434.414 31.2526 434.616 30.7578 435.02 30.3672C435.423 29.9635 435.911 29.7617 436.484 29.7617C437.07 29.7617 437.565 29.9635 437.969 30.3672C438.385 30.7578 438.594 31.2526 438.594 31.8516C438.594 32.4245 438.385 32.9128 437.969 33.3164C437.565 33.7201 437.07 33.9219 436.484 33.9219ZM438.047 59H434.844V39H438.047V59ZM461.133 59H457.93V47.5938C457.93 43.349 456.38 41.2266 453.281 41.2266C451.68 41.2266 450.352 41.832 449.297 43.043C448.255 44.2409 447.734 45.7578 447.734 47.5938V59H444.531V39H447.734V42.3203H447.812C449.323 39.7943 451.51 38.5312 454.375 38.5312C456.562 38.5312 458.236 39.2409 459.395 40.6602C460.553 42.0664 461.133 44.1042 461.133 46.7734V59ZM484.258 57.3984C484.258 64.7422 480.742 68.4141 473.711 68.4141C471.237 68.4141 469.076 67.9453 467.227 67.0078V63.8047C469.479 65.0547 471.628 65.6797 473.672 65.6797C478.594 65.6797 481.055 63.0625 481.055 57.8281V55.6406H480.977C479.453 58.1927 477.161 59.4688 474.102 59.4688C471.615 59.4688 469.609 58.5833 468.086 56.8125C466.576 55.0286 465.82 52.6393 465.82 49.6445C465.82 46.2461 466.634 43.5443 468.262 41.5391C469.902 39.5339 472.142 38.5312 474.98 38.5312C477.676 38.5312 479.674 39.612 480.977 41.7734H481.055V39H484.258V57.3984ZM481.055 49.957V47.0078C481.055 45.4193 480.514 44.0586 479.434 42.9258C478.366 41.793 477.031 41.2266 475.43 41.2266C473.451 41.2266 471.901 41.9492 470.781 43.3945C469.661 44.8268 469.102 46.8385 469.102 49.4297C469.102 51.6562 469.635 53.4401 470.703 54.7812C471.784 56.1094 473.21 56.7734 474.98 56.7734C476.777 56.7734 478.236 56.1354 479.355 54.8594C480.488 53.5833 481.055 51.9492 481.055 49.957Z" fill="#404040"/>
                                <path d="M42.3633 57.8672V54C42.806 54.3906 43.3333 54.7422 43.9453 55.0547C44.5703 55.3672 45.2214 55.6341 45.8984 55.8555C46.5885 56.0638 47.2786 56.2266 47.9688 56.3438C48.6589 56.4609 49.2969 56.5195 49.8828 56.5195C51.901 56.5195 53.4049 56.1484 54.3945 55.4062C55.3971 54.651 55.8984 53.5703 55.8984 52.1641C55.8984 51.4089 55.7292 50.7513 55.3906 50.1914C55.0651 49.6315 54.6094 49.1237 54.0234 48.668C53.4375 48.1992 52.7409 47.7565 51.9336 47.3398C51.1393 46.9102 50.2799 46.4609 49.3555 45.9922C48.3789 45.4974 47.4674 44.9961 46.6211 44.4883C45.7747 43.9805 45.0391 43.4206 44.4141 42.8086C43.7891 42.1966 43.2943 41.5065 42.9297 40.7383C42.5781 39.957 42.4023 39.0456 42.4023 38.0039C42.4023 36.7279 42.6823 35.6211 43.2422 34.6836C43.8021 33.7331 44.5378 32.9518 45.4492 32.3398C46.3607 31.7279 47.3958 31.2721 48.5547 30.9727C49.7266 30.6732 50.918 30.5234 52.1289 30.5234C54.8893 30.5234 56.901 30.8555 58.1641 31.5195V35.2109C56.5104 34.0651 54.388 33.4922 51.7969 33.4922C51.0807 33.4922 50.3646 33.5703 49.6484 33.7266C48.9323 33.8698 48.2943 34.1107 47.7344 34.4492C47.1745 34.7878 46.7188 35.224 46.3672 35.7578C46.0156 36.2917 45.8398 36.9427 45.8398 37.7109C45.8398 38.4271 45.9701 39.0456 46.2305 39.5664C46.5039 40.0872 46.901 40.5625 47.4219 40.9922C47.9427 41.4219 48.5742 41.8385 49.3164 42.2422C50.0716 42.6458 50.9375 43.0885 51.9141 43.5703C52.9167 44.0651 53.8672 44.5859 54.7656 45.1328C55.6641 45.6797 56.4518 46.2852 57.1289 46.9492C57.806 47.6133 58.3398 48.349 58.7305 49.1562C59.1341 49.9635 59.3359 50.888 59.3359 51.9297C59.3359 53.3099 59.0625 54.4818 58.5156 55.4453C57.9818 56.3958 57.2526 57.1706 56.3281 57.7695C55.4167 58.3685 54.362 58.7982 53.1641 59.0586C51.9661 59.332 50.7031 59.4688 49.375 59.4688C48.9323 59.4688 48.3854 59.4297 47.7344 59.3516C47.0833 59.2865 46.4193 59.1823 45.7422 59.0391C45.0651 58.9089 44.4206 58.7461 43.8086 58.5508C43.2096 58.3424 42.7279 58.1146 42.3633 57.8672ZM92.8906 59H89.6875V47.5156C89.6875 45.3021 89.3424 43.7005 88.6523 42.7109C87.9753 41.7214 86.8294 41.2266 85.2148 41.2266C83.8477 41.2266 82.6823 41.8516 81.7188 43.1016C80.7682 44.3516 80.293 45.849 80.293 47.5938V59H77.0898V47.125C77.0898 43.1927 75.5729 41.2266 72.5391 41.2266C71.1328 41.2266 69.974 41.819 69.0625 43.0039C68.151 44.1758 67.6953 45.7057 67.6953 47.5938V59H64.4922V39H67.6953V42.1641H67.7734C69.1927 39.7422 71.263 38.5312 73.9844 38.5312C75.3516 38.5312 76.543 38.9154 77.5586 39.6836C78.5742 40.4388 79.2708 41.4349 79.6484 42.6719C81.1328 39.9115 83.3464 38.5312 86.2891 38.5312C90.6901 38.5312 92.8906 41.2461 92.8906 46.6758V59ZM113.262 59H110.059V55.875H109.98C108.587 58.2708 106.536 59.4688 103.828 59.4688C101.836 59.4688 100.273 58.9414 99.1406 57.8867C98.0208 56.832 97.4609 55.4323 97.4609 53.6875C97.4609 49.9505 99.6615 47.776 104.062 47.1641L110.059 46.3242C110.059 42.9258 108.685 41.2266 105.938 41.2266C103.529 41.2266 101.354 42.0469 99.4141 43.6875V40.4062C101.38 39.1562 103.646 38.5312 106.211 38.5312C110.911 38.5312 113.262 41.0182 113.262 45.9922V59ZM110.059 48.8828L105.234 49.5469C103.75 49.7552 102.63 50.1263 101.875 50.6602C101.12 51.181 100.742 52.112 100.742 53.4531C100.742 54.4297 101.087 55.2305 101.777 55.8555C102.48 56.4674 103.411 56.7734 104.57 56.7734C106.159 56.7734 107.467 56.2201 108.496 55.1133C109.538 53.9935 110.059 52.5807 110.059 50.875V48.8828ZM129.727 42.2422C129.167 41.8125 128.359 41.5977 127.305 41.5977C125.938 41.5977 124.792 42.2422 123.867 43.5312C122.956 44.8203 122.5 46.5781 122.5 48.8047V59H119.297V39H122.5V43.1211H122.578C123.034 41.7148 123.73 40.6211 124.668 39.8398C125.605 39.0456 126.654 38.6484 127.812 38.6484C128.646 38.6484 129.284 38.7396 129.727 38.9219V42.2422ZM142.48 58.8047C141.725 59.2214 140.729 59.4297 139.492 59.4297C135.99 59.4297 134.238 57.4766 134.238 53.5703V41.7344H130.801V39H134.238V34.1172L137.441 33.082V39H142.48V41.7344H137.441V53.0039C137.441 54.3451 137.669 55.3021 138.125 55.875C138.581 56.4479 139.336 56.7344 140.391 56.7344C141.198 56.7344 141.895 56.513 142.48 56.0703V58.8047Z" fill="#404040"/>
                                <path d="M179.914 49.8008H165.793C165.845 52.0273 166.444 53.7461 167.59 54.957C168.736 56.168 170.311 56.7734 172.316 56.7734C174.569 56.7734 176.639 56.0312 178.527 54.5469V57.5547C176.77 58.8307 174.445 59.4688 171.555 59.4688C168.729 59.4688 166.509 58.5638 164.895 56.7539C163.28 54.931 162.473 52.3724 162.473 49.0781C162.473 45.9661 163.352 43.4336 165.109 41.4805C166.88 39.5143 169.074 38.5312 171.691 38.5312C174.309 38.5312 176.333 39.3776 177.766 41.0703C179.198 42.763 179.914 45.1133 179.914 48.1211V49.8008ZM176.633 47.0859C176.62 45.237 176.171 43.7982 175.285 42.7695C174.413 41.7409 173.195 41.2266 171.633 41.2266C170.122 41.2266 168.84 41.7669 167.785 42.8477C166.73 43.9284 166.079 45.3411 165.832 47.0859H176.633ZM195.207 42.2422C194.647 41.8125 193.84 41.5977 192.785 41.5977C191.418 41.5977 190.272 42.2422 189.348 43.5312C188.436 44.8203 187.98 46.5781 187.98 48.8047V59H184.777V39H187.98V43.1211H188.059C188.514 41.7148 189.211 40.6211 190.148 39.8398C191.086 39.0456 192.134 38.6484 193.293 38.6484C194.126 38.6484 194.764 38.7396 195.207 38.9219V42.2422Z" fill="#404040"/>
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M154.489 34C150.905 34 148 36.905 148 40.4886V57.7914C148 61.3749 150.905 64.2799 154.489 64.2799C155.578 64.2799 156.604 64.0116 157.505 63.5374C159.601 62.435 158.124 59.9541 155.757 59.9541C153.862 59.9541 152.326 58.4182 152.326 56.5235V41.7562C152.326 39.8615 153.862 38.3256 155.757 38.3256C158.124 38.3256 159.601 35.8448 157.505 34.7424C156.604 34.2683 155.578 34 154.489 34Z" fill="#FCA311"/>
                                <path fill-rule="evenodd" clip-rule="evenodd" d="M202.021 34C205.605 34 208.51 36.905 208.51 40.4886V57.7914C208.51 61.3749 205.605 64.2799 202.021 64.2799C200.932 64.2799 199.906 64.0116 199.004 63.5374C196.909 62.435 198.385 59.9542 200.753 59.9542C202.648 59.9542 204.183 58.4182 204.183 56.5236V41.7561C204.183 39.8615 202.648 38.3256 200.753 38.3256C198.385 38.3256 196.909 35.8448 199.004 34.7425C199.906 34.2683 200.932 34 202.021 34Z" fill="#FCA311"/>
                            </svg>
                        </div>
                        <div class="image_wrap">

                            <?php $hero_image = get_field( 'hero_image' , 770 ); ?>
                            <?php $mobile_banner_image = get_field( 'mobile_banner_image', 770 ); ?>


                            <div class="display_desctop">
                                <img src="<?php echo esc_url( $hero_image['url'] ); ?>" alt="<?php echo esc_attr( $hero_image['alt'] ); ?>">
                            </div>
                            <div class="display_mobile">
                                <img src="<?php echo esc_url( $mobile_banner_image['url'] ); ?>" alt="<?php echo esc_attr( $mobile_banner_image['alt'] ); ?>" />
                            </div>
                        </div>
                    </div>
                    <div class="banner_content">
                        <h1><?php the_field( 'hero_title', 770 ); ?></h1>

                        <?php $hero_subtitle = get_field( 'hero_subtitle', 770 ); ?>
                        <?php if ( $hero_subtitle ) : ?>
                            <p class="subtitle"><?php the_field( 'hero_subtitle' , 770); ?></p>
                        <?php endif; ?>
                    </div>

                    <div class="banner_link_block">
                        <?php $hero_link = get_field( 'hero_link', 770 ); ?>
                        <?php if ( $hero_link ) : ?>
                            <a class="btn btn_green" href="<?php echo esc_url( $hero_link['url'] ); ?>" target="<?php echo esc_attr( $hero_link['target'] ); ?>"><?php echo esc_html( $hero_link['title'] ); ?></a>
                        <?php endif; ?>
                    </div>

                </div>
                <?php $hero_text = get_field( 'hero_text' , 770); ?>
                <?php if ( $hero_text ) : ?>
                    <div class="hero_bottom_text">
                        <div class="hbt_wrap">
                            <?php the_field( 'hero_text', 770 ); ?>
                        </div>
                    </div>
                <?php endif; ?>
            </div>
        </section>

        <section class="post_loop">
            <div class="container">
                <div class="filters_overlay"></div>
                <div class="blog_with_filters">

                    <div class="filter_aside">
                        <div class="aside_title">
                            <h2>Filter by</h2>
                            <a href="#" class="filter_mobile_close">
                                <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <rect width="30" height="30" rx="15" fill="#EFEFEF"/>
                                    <path d="M9.83768 19.838C9.45597 19.4563 9.45597 18.8374 9.83768 18.4557L13.2935 14.9999L9.83768 11.5441C9.45597 11.1624 9.45597 10.5435 9.83768 10.1618C10.2194 9.78011 10.8383 9.78011 11.22 10.1618L14.6758 13.6176L18.1316 10.1618C18.5133 9.78012 19.1322 9.78011 19.5139 10.1618C19.8956 10.5435 19.8956 11.1624 19.5139 11.5441L16.0581 14.9999L19.5139 18.4557C19.8956 18.8374 19.8956 19.4563 19.5139 19.838C19.1322 20.2197 18.5133 20.2197 18.1316 19.838L14.6758 16.3822L11.22 19.838C10.8383 20.2197 10.2194 20.2197 9.83768 19.838Z" fill="#B2B1B2"/>
                                </svg>
                            </a>
                        </div>

                        <div class="filter_widget">
                            <div class="filter_title">
                                <h3>Content type</h3>
                            </div>
                            <div class="filter_list_wrap">
                                <ul class="filter_list content-type_filter" data-filter="content-type">
                                    <?php
                                    $content_types = get_terms( array(
                                        'taxonomy'   => 'content-type',
                                        'hide_empty' => false
                                    ) );
                                    foreach ( $content_types as $content_type ) {
                                        echo '<li class="filter_item"><label for="' . esc_attr( $content_type->slug ) . '">
                                    <input type="checkbox" id="' . esc_attr( $content_type->slug ) . '">
                                    <span class="item_title">' . esc_html( $content_type->name ) . '</span>
                                    <span class="posts_count">' . intval( $content_type->count ) . '</span>
                                    </label></li>';
                                    }
                                    ?>
                                </ul>
                            </div>
                        </div>

                        <div class="filter_widget">
                            <div class="filter_title">
                                <h3>Industry</h3>
                            </div>
                            <div class="filter_list_wrap">
                                <ul class="filter_list industry_filter" data-filter="industry">
                                    <?php
                                    $industry_types = get_terms( array(
                                        'taxonomy'   => 'industry',
                                        'hide_empty' => false
                                    ) );
                                    foreach ( $industry_types as $industry_type ) {
                                        echo '<li class="filter_item"><label for="' . esc_attr( $industry_type->slug ) . '">
                                    <input type="checkbox" id="' . esc_attr( $industry_type->slug ) . '">
                                    <span class="item_title">' . esc_html( $industry_type->name ) . '</span>
                                    <span class="posts_count">' . intval( $industry_type->count ) . '</span>
                                    </label></li>';
                                    }
                                    ?>
                                </ul>
                            </div>
                        </div>
                        <div class="mobile_filter_btn">
                            <a href="#" class="btn btn_green">Show results</a>
                        </div>
                    </div>
                    <div class="mobile_btn_filter_on">
                        <a href="#" class="filter_on btn btn_blue">Filter by</a>
                    </div>
                    <div class="post_loop_wrap">
                        <?php if ( $query->have_posts() ) : ?>
                            <div class="posts-list">
                                <?php while ( $query->have_posts() ) : $query->the_post(); ?>
                                    <div class="blog_post_item">
                                        <div class="own_wrap">
                                            <div class="loop_post_image">
                                                <?php echo get_the_post_thumbnail( get_the_ID(), 'medium', [
                                                    'class' => 'blog-thumbnail',
                                                    'sizes' => '(max-width: 768px) 100vw, 768px'
                                                ] ); ?>
                                            </div>
                                            <div class="loop_post_title">
                                                <?php the_title('<h2>', '</h2>'); ?>
                                            </div>
                                            <div class="loop_post_content">
                                                <?php
                                                echo '<p>';
                                                do_excerpt(get_the_excerpt(), 20);
                                                echo '</p>';
                                                ?>

                                            </div>
                                        </div>
                                        <div class="bottom_btn">
                                            <a href="<?php the_permalink(); ?>" class="btn btn_lightblue">Continue Reading</a>
                                        </div>
                                    </div>
                                <?php endwhile; ?>
                            </div>
                            <div class="pagination">
                                <?php
                                $links_array = paginate_links( array(
                                    'total'      => $query->max_num_pages,
                                    'current'    => $paged,
                                    'base'       => trailingslashit( $blog_page_url ) . 'page/%#%/',
                                    'format'     => '',
                                    'prev_text'  => '<span aria-hidden="true">&lt;</span>',
                                    'next_text'  => '<span aria-hidden="true">&gt;</span>',
                                    'type'       => 'array',
                                ) );

                                if ( empty($links_array) ) {
                                    return;
                                }

                                $custom_links = array();
                                foreach ( $links_array as $link_html ) {

                                    // Если элемент содержит "prev page-numbers", принудительно генерируем стрелку "Предыдущая" как ссылку
                                    if ( strpos( $link_html, 'prev page-numbers' ) !== false || strpos( $link_html, '&lt;' ) !== false ) {
                                        $prev_page = ($paged > 1) ? $paged - 1 : 1;
                                        $href = ($prev_page == 1)
                                            ? trailingslashit( $blog_page_url )
                                            : trailingslashit( $blog_page_url ) . 'page/' . $prev_page . '/';
                                        $generated = '<li class="prev"><a href="' . esc_url( $href ) . '" tabindex="0" role="button" aria-disabled="false" aria-label="Previous page" rel="prev">&lt;</a></li>';
                                        $custom_links[] = $generated;
                                        continue;
                                    }
                                    // Если элемент содержит "next page-numbers", генерируем стрелку "Следующая"
                                    if ( strpos( $link_html, 'next page-numbers' ) !== false || strpos( $link_html, '&gt;' ) !== false ) {
                                        $next_page = ($paged < $query->max_num_pages) ? $paged + 1 : $query->max_num_pages;
                                        $href = trailingslashit( $blog_page_url ) . 'page/' . $next_page . '/';
                                        $generated = '<li class="next"><a href="' . esc_url( $href ) . '" tabindex="0" role="button" aria-disabled="false" aria-label="Next page" rel="next">&gt;</a></li>';
                                        $custom_links[] = $generated;
                                        continue;
                                    }

                                    // Если элемент содержит <span>, это либо текущая страница, либо многоточие
                                    if ( strpos( $link_html, '<span' ) !== false ) {
                                        // Если это текущая страница
                                        if ( strpos( $link_html, 'current' ) !== false ) {
                                            $class        = 'class="selected"';
                                            $aria_current = 'aria-current="page"';
                                            $rel          = 'rel="canonical"';
                                            // Здесь делаем текущую страницу кликабельной, поэтому tabindex="0"
                                            $tabindex     = '0';
                                            if ( preg_match( '/<span[^>]*>([^<]+)<\/span>/', $link_html, $m ) ) {
                                                $text = $m[1];
                                            } else {
                                                $text = '?';
                                            }
                                            $aria_label = 'aria-label="Page ' . $text . ' is your current page"';
                                            // Формируем URL для текущей страницы: для 1-й страницы используем базовый URL
                                            $page_num = intval( $text );
                                            if ( $page_num === 1 ) {
                                                $current_href = trailingslashit( $blog_page_url );
                                            } else {
                                                $current_href = trailingslashit( $blog_page_url ) . 'page/' . $page_num . '/';
                                            }
                                            $generated = '<li ' . $class . '><a href="' . esc_url( $current_href ) . '" ' . $aria_current . ' ' . $aria_label . ' ' . $rel . ' tabindex="' . $tabindex . '">' . $text . '</a></li>';
                                        } else {
                                            // Если это многоточие (например, "…")
                                            $dots_text = strip_tags($link_html);
                                            $generated = '<li><span>' . $dots_text . '</span></li>';
                                        }
                                    } else {
                                        // Элемент – это ссылка <a> (обычная числовая страница)
                                        $href = '#';
                                        $text = '';
                                        if ( preg_match( '/href="([^"]+)"/', $link_html, $href_m ) ) {
                                            $href = $href_m[1];
                                        }
                                        if ( preg_match( '/>([^<]+)<\/a>/', $link_html, $text_m ) ) {
                                            $text = $text_m[1];
                                        }
                                        $aria_label = 'aria-label="Page ' . $text . '"';
                                        $generated = '<li><a href="' . esc_url( $href ) . '" tabindex="0" aria-disabled="false" ' . $aria_label . '>' . $text . '</a></li>';
                                    }

                                    $custom_links[] = $generated;
                                }

                                // Опционально: Если необходимо добавить rel="prev" и rel="next" для соседних ссылок числовой пагинации,
                                // можно найти индекс текущей страницы (по наличию aria-current) и добавить атрибуты к соседним элементам.
                                $current_index = null;
                                for ( $i = 0; $i < count($custom_links); $i++ ) {
                                    if ( strpos( $custom_links[$i], 'aria-current="page"' ) !== false ) {
                                        $current_index = $i;
                                        break;
                                    }
                                }
                                if ( $current_index !== null ) {
                                    if ( $current_index > 0 ) {
                                        if ( strpos( $custom_links[$current_index - 1], '<a' ) !== false && strpos( $custom_links[$current_index - 1], 'rel="prev"' ) === false ) {
                                            $custom_links[$current_index - 1] = preg_replace('/<a /', '<a rel="prev" ', $custom_links[$current_index - 1]);
                                        }
                                    }
                                    if ( $current_index < count($custom_links) - 1 ) {
                                        if ( strpos( $custom_links[$current_index + 1], '<a' ) !== false && strpos( $custom_links[$current_index + 1], 'rel="next"' ) === false ) {
                                            $custom_links[$current_index + 1] = preg_replace('/<a /', '<a rel="next" ', $custom_links[$current_index + 1]);
                                        }
                                    }
                                }

                                echo '<nav><ul role="navigation" aria-label="Pagination">';
                                foreach ( $custom_links as $link ) {
                                    echo $link;
                                }
                                echo '</ul></nav>';
                                ?>
                            </div>
                        <?php else : ?>
                            <p><?php esc_html_e( 'Nothing found', 'your-textdomain' ); ?></p>
                        <?php endif; wp_reset_postdata(); ?>
                    </div>
                </div>
            </div>
        </section>


    </main>

<?php

get_footer();
